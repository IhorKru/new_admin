{% extends "base.html.twig" %}

{% block title %}Mediaff | Email Analysis{% endblock %}

{% block custcss %}
    <script src="{{ asset('https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js') }}"></script>
    <script src="{{ asset('https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js') }}"></script>
{% endblock %}

{% block body %}
    <div class="">
        <div class="row">
            <!-- form input mask -->
            <div class="col-md-4 col-sm-4 col-xs-12">
                <div class="x_panel">
                    <div class="x_title">
                        {{ form_start(form, {'attr': {'novalidate': 'novalidate', 'id': 'emailcheckform'}}) }}
                            {{ form_widget(form.submit) }}
                        {{ form_end(form) }}
                    </div>
                </div>
            </div>
            <!-- /form input mask -->
            <!-- progress bar -->
            <div class="col-md-8 col-sm-12 col-xs-12" style="display: none" id="progress_show">
                <div class="x_panel">
                    <div class="x_title">
                        <div class="progress">
                            <div id="progress_bar" class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="" aria-valuemin="0" aria-valuemax="100" style="width:0">

                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- campaign stats -->
            <div id="campstats">

            </div>
        </div>
    </div>
{% endblock %}

{% block custjs %}
    <script>
        /*
        * Submitting the form for email validation
        */
        $("#emailcheckform").submit(function(e) {
            e.preventDefault();
            if ( $("#progress_show").css('display') == 'none' ){
                $("#progress_show").show(); //showing progress bar
                $("#progress_bar").attr("aria-valuemin", "0%"); //assigning initial value to progress bar
            } else {
                $("#progress_bar").attr("style", "width: 0%");
                $("#progress_bar").attr("aria-valuenow", "0%");
            }
            var $form = $(e.currentTarget);
            var formSubmit = function () {
                $.ajax({
                    url: $form.attr('action'),
                    method: 'POST',
                    data: $form.serialize(),
                    timeout: 1000,
                    success: function( response ) {
                        console.log( response );
                    },
                    error: function( response ) {
                        console.log( response );
                    }
                });
            };
            formSubmit();
        });
    </script>
{% endblock %}